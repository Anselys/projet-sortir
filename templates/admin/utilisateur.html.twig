{% extends 'base.html.twig' %}

{% block title %}{{ parent() }} | Admin - Gérer les utilisateurs{% endblock %}

{% block main %}
    <h2>Gérer les utilisateurs</h2>
    <section>
        {{ form_errors(search_form) }}
        {{ form_start(search_form) }}
        {{ form_end(search_form) }}
    </section>
    <section>
        <table class="table table-dark table-striped">
            <thead>
            <tr>
                <th scope="col">Prénom et nom</th>
                <th scope="col">Email</th>
                <th scope="col">Statut</th>
                <th scope="col">Actions</th>
            </tr>
            </thead>
            {% for utilisateur in utilisateurs %}
                {% set statut = utilisateur.isActif ? 'actif' : 'inactif' %}
                {% set nouveauStatut = utilisateur.isActif ? 'inactif' : 'actif' %}
                {% set statutBtnText = utilisateur.isActif ? 'Rendre inactif' : 'Rendre actif' %}
                {% set prenomNom = utilisateur.prenom ~ ' ' ~ utilisateur.nom|upper %}

                <tr>
                    <td>{{ prenomNom }}</td>
                    <td>{{ utilisateur.email }}</td>
                    <td class="{{  utilisateur.isActif ? 'text-success' : 'text-danger' }}">{{ statut|capitalize }}</td>
                    <td>
                        <a
                            href="{{ path('app_admin_changer_statut_utilisateur', { id: utilisateur.id }) }}"
                            class="btn {{ utilisateur.isActif ? 'btn-secondary' : 'btn-info' }}"
                            onclick="return confirm('Rendre {{ prenomNom }} {{ nouveauStatut }} ?')"
                        >
                            {{ statutBtnText }}
                        </a>
                        <a
                            href="{{ path('app_admin_utilisateur_delete', { id: utilisateur.id, token: csrf_token('utilisateur_delete' ~ utilisateur.id) }) }}"
                            onclick="return confirm('Êtes-vous sûr(e) de vouloir supprimer cet utilisateur ?')"
                            class="btn btn-danger">Supprimer</a>
                    </td>
                     </tr>
            {% endfor %}
        </table>
    </section>
{% endblock %}
